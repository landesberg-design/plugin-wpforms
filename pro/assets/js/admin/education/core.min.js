"use strict";var WPFormsEducation=window.WPFormsEducation||{};WPFormsEducation.proCore=window.WPFormsEducation.proCore||function(t,i,c){var a={},r={init:function(){a.spinner='<i class="wpforms-loading-spinner wpforms-loading-white wpforms-loading-inline"></i>',c(r.ready)},ready:function(){r.events()},events:function(){r.openModalButtonClick(),r.activateButtonClick()},openModalButtonClick:function(){c(t).on("click",".education-modal",function(t){var n=c(this);switch(t.preventDefault(),t.stopImmediatePropagation(),n.data("action")){case"activate":r.activateModal(n.data("name"),n.data("path"),n.data("nonce"));break;case"install":r.installModal(n.data("name"),n.data("url"),n.data("nonce"),n.data("license"));break;case"upgrade":r.upgradeModal(n.data("name"),n.data("field-name"),n.data("license"),n.data("video"));break;case"license":r.licenseModal()}})},activateButtonClick:function(){c(".wpforms-education-toggle-plugin-btn").on("click",function(t){var n,e,o,a,i=c(this);t.preventDefault(),t.stopImmediatePropagation(),i.hasClass("inactive")||(i.addClass("inactive"),n=i.closest(".wpforms-addon-form, .wpforms-setting-row-education"),e=i.text(),o=i.data("plugin"),t=i.data("action"),a=i.data("type"),i.html(WPFormsAdmin.settings.iconSpinner+e),WPFormsAdmin.setAddonState(o,t,a,function(t){t.success?location.reload():(n.append('<div class="msg error" style="display: none">'+wpforms_admin[a+"_error"]+"</div>"),n.find(".msg").slideDown()),i.text(e),setTimeout(function(){i.removeClass("inactive"),n.find(".msg").slideUp("",function(){c(this).remove()})},5e3)}))})},activateModal:function(t,n,e){c.alert({title:!1,content:wpforms_education.activate_prompt.replace(/%name%/g,t),icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_education.activate_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.activating),this.$$cancel.prop("disabled",!0),r.activateAddon(n,e,this),!1}},cancel:{text:wpforms_education.cancel}}})},activateAddon:function(t,n,e){c.post(wpforms_education.ajax_url,{action:"wpforms_activate_addon",nonce:n,plugin:t},function(t){e.close(),t.success?r.saveModal():c.alert({title:!1,content:t.data,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})})},saveModal:function(t){t=t||wpforms_education.activated,c.alert({title:t.replace(/\.$/,""),content:wpforms_education.save_prompt,icon:"fa fa-check-circle",type:"green",buttons:{confirm:{text:wpforms_education.save_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){if("undefined"!=typeof WPFormsBuilder)return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.saving),this.$$cancel.prop("disabled",!0),WPFormsBuilder.formIsSaved()&&location.reload(),WPFormsBuilder.formSave().done(function(){location.reload()}),!1;location.reload()}},cancel:{text:wpforms_education.close}}})},installModal:function(t,n,e,o){n&&""!==n?c.alert({title:!1,content:wpforms_education.install_prompt.replace(/%name%/g,t),icon:"fa fa-info-circle",type:"blue",boxWidth:"425px",buttons:{confirm:{text:wpforms_education.install_confirm,btnClass:"btn-confirm",keys:["enter"],isHidden:!wpforms_education.can_install_addons,action:function(){return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.installing),this.$$cancel.prop("disabled",!0),r.installAddon(n,e,this),!1}},cancel:{text:wpforms_education.cancel}}}):r.upgradeModal(t,"",o,"")},installAddon:function(t,n,e){c.post(wpforms_education.ajax_url,{action:"wpforms_install_addon",nonce:n,plugin:t},function(t){var n;e.close(),t.success?r.saveModal(t.data.msg):(n=t.data,"object"==typeof t.data&&(n=wpforms_education.addon_error),c.alert({title:!1,content:n,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}}))})},upgradeModal:function(n,t,e,o){var a;void 0!==e&&0!==e.length||(e="pro"),c.inArray(e,["pro","elite"])<0||(a=n+" "+wpforms_education.upgrade[e].title,void 0!==t&&0<t.length&&(a=t+" "+wpforms_education.upgrade[e].title),c.alert({title:a,icon:"fa fa-lock",content:wpforms_education.upgrade[e].message.replace(/%name%/g,n),boxWidth:"550px",theme:"modern,wpforms-education",onOpenBefore:function(){_.isEmpty(o)||this.$btnc.after('<iframe src="'+o+'" class="pro-feature-video" frameborder="0" allowfullscreen="" width="490" height="276"></iframe>'),this.$body.find(".jconfirm-content").addClass("lite-upgrade")},buttons:{confirm:{text:wpforms_education.upgrade[e].button,btnClass:"btn-confirm",keys:["enter"],action:function(){var t=/(\?)/.test(wpforms_education.upgrade[e].url)?"&":"?",t=wpforms_education.upgrade[e].url+t+"utm_content="+encodeURIComponent(n.trim());i.open(t,"_blank")}}}}))},licenseModal:function(){c.alert({title:!1,content:wpforms_education.license_prompt,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})}};return r}(document,window,jQuery),WPFormsEducation.proCore.init();