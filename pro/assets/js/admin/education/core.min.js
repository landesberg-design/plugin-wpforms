"use strict";var WPFormsEducation=window.WPFormsEducation||{};WPFormsEducation.proCore=window.WPFormsEducation.proCore||function(t,c,r){var a={},i={init:function(){a.spinner='<i class="wpforms-loading-spinner wpforms-loading-white wpforms-loading-inline"></i>',r(i.ready)},ready:function(){i.events()},events:function(){i.openModalButtonClick(),i.activateButtonClick()},openModalButtonClick:function(){r(t).on("click",".education-modal",function(t){var n=r(this);switch(t.preventDefault(),t.stopImmediatePropagation(),n.data("action")){case"activate":i.activateModal(n.data("name"),n.data("path"),n.data("nonce"));break;case"install":i.installModal(n.data("name"),n.data("url"),n.data("nonce"),n.data("license"));break;case"upgrade":i.upgradeModal(n.data("name"),n.data("field-name"),WPFormsEducation.core.getUTMContentValue(n),n.data("license"),n.data("video"));break;case"license":i.licenseModal()}})},activateButtonClick:function(){r(".wpforms-education-toggle-plugin-btn").on("click",function(t){var n,e,o,a,i=r(this);t.preventDefault(),t.stopImmediatePropagation(),i.hasClass("inactive")||(i.addClass("inactive"),n=i.closest(".wpforms-addon-form, .wpforms-setting-row-education"),e=i.text(),o=i.data("plugin"),t=i.data("action"),a=i.data("type"),i.html(WPFormsAdmin.settings.iconSpinner+e),WPFormsAdmin.setAddonState(o,t,a,function(t){t.success?location.reload():(n.append('<div class="msg error" style="display: none">'+wpforms_admin[a+"_error"]+"</div>"),n.find(".msg").slideDown()),i.text(e),setTimeout(function(){i.removeClass("inactive"),n.find(".msg").slideUp("",function(){r(this).remove()})},5e3)}))})},activateModal:function(t,n,e){r.alert({title:!1,content:wpforms_education.activate_prompt.replace(/%name%/g,t),icon:"fa fa-info-circle",type:"blue",buttons:{confirm:{text:wpforms_education.activate_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.activating),this.$$cancel.prop("disabled",!0),i.activateAddon(n,e,this),!1}},cancel:{text:wpforms_education.cancel}}})},activateAddon:function(t,n,e){r.post(wpforms_education.ajax_url,{action:"wpforms_activate_addon",nonce:n,plugin:t},function(t){e.close(),t.success?i.saveModal():r.alert({title:!1,content:t.data,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})})},saveModal:function(t){t=t||wpforms_education.activated,r.alert({title:t.replace(/\.$/,""),content:wpforms_education.save_prompt,icon:"fa fa-check-circle",type:"green",buttons:{confirm:{text:wpforms_education.save_confirm,btnClass:"btn-confirm",keys:["enter"],action:function(){if("undefined"!=typeof WPFormsBuilder)return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.saving),this.$$cancel.prop("disabled",!0),WPFormsBuilder.formIsSaved()&&location.reload(),WPFormsBuilder.formSave().done(function(){location.reload()}),!1;location.reload()}},cancel:{text:wpforms_education.close}}})},installModal:function(t,n,e,o){n&&""!==n?r.alert({title:!1,content:wpforms_education.install_prompt.replace(/%name%/g,t),icon:"fa fa-info-circle",type:"blue",boxWidth:"425px",buttons:{confirm:{text:wpforms_education.install_confirm,btnClass:"btn-confirm",keys:["enter"],isHidden:!wpforms_education.can_install_addons,action:function(){return this.$$confirm.prop("disabled",!0).html(a.spinner+wpforms_education.installing),this.$$cancel.prop("disabled",!0),i.installAddon(n,e,this),!1}},cancel:{text:wpforms_education.cancel}}}):i.upgradeModal(t,"","Empty install URL",o,"")},installAddon:function(t,n,e){r.post(wpforms_education.ajax_url,{action:"wpforms_install_addon",nonce:n,plugin:t},function(t){var n;e.close(),t.success?i.saveModal(t.data.msg):(n=t.data,"object"==typeof t.data&&(n=wpforms_education.addon_error),r.alert({title:!1,content:n,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}}))})},upgradeModal:function(t,n,e,o,a){var i;void 0!==o&&0!==o.length||(o="pro"),r.inArray(o,["pro","elite"])<0||(i=t+" "+wpforms_education.upgrade[o].title,void 0!==n&&0<n.length&&(i=n+" "+wpforms_education.upgrade[o].title),r.alert({title:i,icon:"fa fa-lock",content:wpforms_education.upgrade[o].message.replace(/%name%/g,t),boxWidth:"550px",theme:"modern,wpforms-education",closeIcon:!0,onOpenBefore:function(){_.isEmpty(a)||this.$btnc.after('<iframe src="'+a+'" class="pro-feature-video" frameborder="0" allowfullscreen="" width="490" height="276"></iframe>'),this.$body.find(".jconfirm-content").addClass("lite-upgrade")},buttons:{confirm:{text:wpforms_education.upgrade[o].button,btnClass:"btn-confirm",keys:["enter"],action:function(){c.open(WPFormsEducation.core.getUpgradeURL(e,o),"_blank")}}}}))},licenseModal:function(){r.alert({title:!1,content:wpforms_education.license_prompt,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_education.close,btnClass:"btn-confirm",keys:["enter"]}}})}};return i}(document,window,jQuery),WPFormsEducation.proCore.init();